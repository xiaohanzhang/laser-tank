import { map } from 'lodash';
import React from 'react';
import { useDispatch } from 'react-redux';

import './App.css';
import { exec } from '../features/game/game';
import Board from '../features/game/Board';
import MenuBar from '../features/ui/MenuBar';

const App: React.FC = () => {
  const dispatch = useDispatch();
  // useEffect(() => {
  //   dispatch(loadLevel([
  //     [
  //       [2, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 3, 0, 0, 5, 0, 0, 0, 24, 24, 0, 0, 25, 0, 0, 0],
  //       [0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 25, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 20, 0, 0, 22, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 23, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 0, 12, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 16, 16, 0, 0, 0, 0, 0, 0],
  //       [0, 8, 6, 0, 0, 0, 0, 0, 15, 0, 14, 0, 13, 0, 0, 0],
  //       [0, 0, 15, 0, 0, 0, 0, 0, 15, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0],
  //       [0, 8, 19, 1, 0, 0, 18, 18, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 7, 0, 0, 0, 0, 0, 17, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //     ],
  //     [
  //       [2, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 3, 0, 0, 5, 0, 0, 0, 24, 24, 0, 0, 25, 0, 0, 0],
  //       [0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 25, 0, 0],
  //       [0, 64, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 64, 0, 64, 20, 0, 0, 22, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 5, 0, 5, 0, 0, 23, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 5, 0, 5, 0, 65, 0, 0, 0, 11, 0, 12, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 16, 16, 0, 0, 0, 0, 0, 0],
  //       [0, 8, 6, 0, 0, 0, 0, 0, 15, 0, 14, 0, 13, 0, 0, 0],
  //       [0, 0, 15, 0, 65, 0, 0, 0, 15, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 5, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0],
  //       [0, 8, 19, 1, 0, 0, 18, 18, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 7, 0, 5, 0, 0, 0, 17, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  //     ],
  //   ][1]));
  // }, [dispatch]);

  return (
    <div className="App">
      <MenuBar/>
      <div className="main">
        <Board/>
        <div className="control-panel">
          <div className="info"></div>
          <div className="control">
            {map([
              [{name: 'Undo', cmd: 'UNDO'}, {name: 'Hint', cmd: 'HINT'}],
              [{name: 'Save Position', cmd: ''}],
              [{name: 'Restore Position', cmd: ''}],
              [{name: 'New', cmd: ''}, {name: 'Restart', cmd: ''}],
              [{name: 'Load Level', cmd: ''}],
              [{name: '<< Level', cmd: 'PREV_LEVEL'}, {name: 'Level >>', cmd: 'NEXT_LEVEL'}],
            ], (row, i) => {
              return <div key={i}>
                {map(row, ({name, cmd}, j) => {
                  return <div key={j} onClick={() => {
                    if (cmd) {
                      dispatch(exec(cmd))
                    }
                  }}>{name}</div>
                })}
              </div>
            })}
          </div>
        </div>
      </div>
    </div>
  );
}

export default App;
