(this.webpackJsonplasertank=this.webpackJsonplasertank||[]).push([[0],{38:function(e,t,n){e.exports=n(58)},47:function(e,t,n){},48:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var a,r,c=n(0),i=n.n(c),o=n(21),l=n.n(o),u=n(10),s=(n(47),n(48),n(16)),d=n.n(s),O=n(20),b=n(36),f=n(7),v=n(4),h=n(8),j=n(1),E=n(17),R=n(9),T=n(5),p=n(3),_=n(6),m=n(2);!function(e){e[e.FLAG=1]="FLAG",e[e.DIRT=2]="DIRT",e[e.WATER=3]="WATER",e[e.MOVABLE_BLOCK_WATER=4]="MOVABLE_BLOCK_WATER",e[e.ICE=5]="ICE",e[e.THIN_ICE=6]="THIN_ICE",e[e.TANK_MOVER_N=7]="TANK_MOVER_N",e[e.TANK_MOVER_S=8]="TANK_MOVER_S",e[e.TANK_MOVER_E=9]="TANK_MOVER_E",e[e.TANK_MOVER_W=10]="TANK_MOVER_W",e[e.TUNNEL=11]="TUNNEL"}(a||(a={})),function(e){e[e.BRICKS=32]="BRICKS",e[e.SOLID_BLOCK=33]="SOLID_BLOCK",e[e.CRYSTAL_BLOCK=34]="CRYSTAL_BLOCK",e[e.MOVABLE_BLOCK=35]="MOVABLE_BLOCK",e[e.ANTI_TANK_N=36]="ANTI_TANK_N",e[e.ANTI_TANK_S=37]="ANTI_TANK_S",e[e.ANTI_TANK_W=38]="ANTI_TANK_W",e[e.ANTI_TANK_E=39]="ANTI_TANK_E",e[e.ANTI_TANK_DEAD_N=40]="ANTI_TANK_DEAD_N",e[e.ANTI_TANK_DEAD_S=41]="ANTI_TANK_DEAD_S",e[e.ANTI_TANK_DEAD_W=42]="ANTI_TANK_DEAD_W",e[e.ANTI_TANK_DEAD_E=43]="ANTI_TANK_DEAD_E",e[e.MIRROR_NW=44]="MIRROR_NW",e[e.MIRROR_NE=45]="MIRROR_NE",e[e.MIRROR_SE=46]="MIRROR_SE",e[e.MIRROR_SW=47]="MIRROR_SW",e[e.ROTARY_MIRROR_NW=48]="ROTARY_MIRROR_NW",e[e.ROTARY_MIRROR_NE=49]="ROTARY_MIRROR_NE",e[e.ROTARY_MIRROR_SE=50]="ROTARY_MIRROR_SE",e[e.ROTARY_MIRROR_SW=51]="ROTARY_MIRROR_SW",e[e.TANT=52]="TANT"}(r||(r={}));var A,y=function(e,t){return e===t||!!e&&!!t&&e.x===t.x&&e.y===t.y},g=function(e,t){if(e.x!==t.x||e.y!==t.y){if(e.x===t.x)return e.y>t.y?A.UP:A.DOWN;if(e.y===t.y)return e.x>t.x?A.LEFT:A.RIGHT}return null},N=function(e){var t;return(t={},Object(m.a)(t,A.UP,A.DOWN),Object(m.a)(t,A.DOWN,A.UP),Object(m.a)(t,A.LEFT,A.RIGHT),Object(m.a)(t,A.RIGHT,A.LEFT),t)[e]},k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(null===e.laser||n)&&(e.laser=t,y(t,e.tank)&&(e.status="FAIL"))},I=function(e,t){var n=e.x,a=e.y,r=Object(j.get)(t,"".concat(a,".").concat(n));return!(!r||r.object)},L=function(e){var t,n=e.x,a=e.y,r=e.direction;return(t={},Object(m.a)(t,A.UP,{x:n,y:a-1,direction:r}),Object(m.a)(t,A.DOWN,{x:n,y:a+1,direction:r}),Object(m.a)(t,A.RIGHT,{x:n+1,y:a,direction:r}),Object(m.a)(t,A.LEFT,{x:n-1,y:a,direction:r}),t)[r]},x=function(){function e(){Object(v.a)(this,e),this.css=""}return Object(h.a)(e,[{key:"handleLeaving",value:function(e,t){}},{key:"pending",value:function(e,t,n,a){e.pending.push({from:t,to:n})}}],[{key:"createEmptyBoard",value:function(){return Object(j.range)(0,xe).map((function(){return Object(j.range)(0,xe).map((function(){return{background:a.DIRT}}))}))}},{key:"getBackgroundClass",value:function(e){var t;return(t={},Object(m.a)(t,a.FLAG,ce),Object(m.a)(t,a.DIRT,te),Object(m.a)(t,a.WATER,ie),Object(m.a)(t,a.MOVABLE_BLOCK_WATER,ne),Object(m.a)(t,a.ICE,oe),Object(m.a)(t,a.THIN_ICE,le),Object(m.a)(t,a.TANK_MOVER_N,ue),Object(m.a)(t,a.TANK_MOVER_S,se),Object(m.a)(t,a.TANK_MOVER_E,Oe),Object(m.a)(t,a.TANK_MOVER_W,de),Object(m.a)(t,a.TUNNEL,re),t)[e]}},{key:"getObstacleClass",value:function(e){var t;return(t={},Object(m.a)(t,r.BRICKS,C),Object(m.a)(t,r.SOLID_BLOCK,D),Object(m.a)(t,r.CRYSTAL_BLOCK,Z),Object(m.a)(t,r.MOVABLE_BLOCK,K),Object(m.a)(t,r.ANTI_TANK_N,w),Object(m.a)(t,r.ANTI_TANK_S,W),Object(m.a)(t,r.ANTI_TANK_W,B),Object(m.a)(t,r.ANTI_TANK_E,F),Object(m.a)(t,r.ANTI_TANK_DEAD_N,P),Object(m.a)(t,r.ANTI_TANK_DEAD_S,V),Object(m.a)(t,r.ANTI_TANK_DEAD_W,U),Object(m.a)(t,r.ANTI_TANK_DEAD_E,G),Object(m.a)(t,r.MIRROR_NW,Y),Object(m.a)(t,r.MIRROR_NE,H),Object(m.a)(t,r.MIRROR_SE,z),Object(m.a)(t,r.MIRROR_SW,X),Object(m.a)(t,r.ROTARY_MIRROR_NW,J),Object(m.a)(t,r.ROTARY_MIRROR_NE,q),Object(m.a)(t,r.ROTARY_MIRROR_SE,$),Object(m.a)(t,r.ROTARY_MIRROR_SW,Q),Object(m.a)(t,r.TANT,S),t)[e]}},{key:"getBackground",value:function(e){return new(this.getBackgroundClass(e.background))}},{key:"getObstacle",value:function(e){return e.object?new(this.getObstacleClass(e.object)):null}},{key:"checkLaser",value:function(e){var t=e.laser,n=e.tank,a=e.board;if(t){var r,c=L(t),i=Object(j.get)(a,[c.y,c.x]);if(i)if(e.laser=c,y(c,n))e.status="FAIL";else null===(r=this.getObstacle(i))||void 0===r||r.handleLaser(e,c);else e.laser=null;e.laser||this.checkFire(e)}}},{key:"checkPending",value:function(e){var t=this,n=e.pending;"FAIL"!==e.status&&(e.pending=[],Object(j.each)(Object(j.reverse)(n),(function(n){var a=n.from,r=n.to;t.handlePending(e,a,r)})),e.pending=Object(j.reverse)(e.pending))}},{key:"handlePending",value:function(e,t,n){var a=e.board,r=Object(j.get)(a,[n.y,n.x]);if(t){var c=Object(j.get)(a,[t.y,t.x]);this.getBackground(c).handleLeaving(e,t)}return this.getBackground(r).handleLanding(e,t,n),"FAIL"!==e.status}},{key:"checkTank",value:function(e,t){var n=e.board,a=e.tank,r=n[a.y][a.x];if("FAIL"!==e.status){r.object||this.checkFire(e);var c=this.getBackground(n[a.y][a.x]);c.shouldCheckTank(e,t)&&c.handleTank(e,!1)}}},{key:"checkFire",value:function(e){var t=this,n=e.board,a=e.tank;n[a.y][a.x].object||"FAIL"===e.status||Object(j.each)([A.RIGHT,A.LEFT,A.DOWN,A.UP],(function(r){return function(e,t,n){for(var a=L(t);a.x<xe&&a.y<xe&&a.x>=0&&a.y>=0&&!1!==n(e[a.y][a.x],a);)a=L(a)}(n,Object(f.a)({},a,{direction:r}),(function(n,a){var r;return null===(r=t.getObstacle(n))||void 0===r?void 0:r.sawTank(e,a)})),"FAIL"!==e.status}))}},{key:"cleanUp",value:function(e){var t=this,n=e.cleanUp,a=e.board;e.cleanUp=[],Object(j.each)(n,(function(n){t.getBackground(a[n.y][n.x]).cleanUp(e,n)}))}},{key:"moveTank",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.board,o=t.tank,l=i[n.y][n.x],u=e.getBackground(l);t.prevTank=Object(f.a)({},o),I(n,t.board)&&(o.x=n.x,o.y=n.y,t.rendering=!0,l.background===a.TUNNEL&&u.handleTankMove(t),e.checkFire(t),"FAIL"!==t.status&&(r?u.handleTank(t,!0):c||u.skipTank(t)))}},{key:"getObstacleCss",value:function(e){var t;return null===(t=this.getObstacle(e))||void 0===t?void 0:t.css}},{key:"getBackgroundCss",value:function(e){var t;return null===(t=this.getBackground(e))||void 0===t?void 0:t.css}}]),e}(),M=function(e){function t(){return Object(v.a)(this,t),Object(T.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLaser",value:function(e,t){e.laser=null}},{key:"sawTank",value:function(e,t){return!1}},{key:"skipLaser",value:function(e){}},{key:"handleMove",value:function(e,t,n,r){var c=e.board,i=e.pending,o=c[t.y][t.x];n||(n=L(t));var l=i.findIndex((function(e){return y(e.to,t)}));if(l>-1&&i.splice(l,1),o.object&&I(n,c)){var u=Object(j.get)(c,[n.y,n.x]);u.object=o.object,delete o.object,u.background===a.TUNNEL?x.handlePending(e,t,n):x.getBackground(u).pending(e,t,n,r)}}}]),t}(x),S=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="tank TANK_N",n}return Object(_.a)(t,e),t}(M),C=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="BRICKS",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLaser",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleLaser",this).call(this,e,n),delete e.board[n.y][n.x].object}}]),t}(M),D=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="SOLID_BLOCK",n}return Object(_.a)(t,e),t}(M),K=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="MOVABLE_BLOCK",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLaser",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleLaser",this).call(this,e,n),this.handleMove(e,n,null,!0)}}]),t}(M),w=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(c)))).css="ANTI_TANK_N",n.dead=r.ANTI_TANK_DEAD_N,n.dead_direction=A.DOWN,n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLaser",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleLaser",this).call(this,e,n),n.direction===this.dead_direction?e.board[n.y][n.x].object=this.dead:this.handleMove(e,n,null,!0)}},{key:"sawTank",value:function(e,n){var a=e.tank,r=N(this.dead_direction);return g(n,a)===r&&k(e,L(Object(f.a)({},n,{direction:r}))),Object(R.a)(Object(p.a)(t.prototype),"sawTank",this).call(this,e,n)}}]),t}(M),W=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(c)))).css="ANTI_TANK_S",n.dead=r.ANTI_TANK_DEAD_S,n.dead_direction=A.UP,n}return Object(_.a)(t,e),t}(w),F=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(c)))).css="ANTI_TANK_E",n.dead=r.ANTI_TANK_DEAD_E,n.dead_direction=A.LEFT,n}return Object(_.a)(t,e),t}(w),B=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(c)))).css="ANTI_TANK_W",n.dead=r.ANTI_TANK_DEAD_W,n.dead_direction=A.RIGHT,n}return Object(_.a)(t,e),t}(w),P=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="ANTI_TANK_DEAD_N",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLaser",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleLaser",this).call(this,e,n),this.handleMove(e,n,n,!0)}}]),t}(M),V=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="ANTI_TANK_DEAD_S",n}return Object(_.a)(t,e),t}(P),U=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="ANTI_TANK_DEAD_W",n}return Object(_.a)(t,e),t}(P),G=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="ANTI_TANK_DEAD_E",n}return Object(_.a)(t,e),t}(P),Y=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="MIRROR_NW",n.directions=[A.UP,A.LEFT],n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLaser",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleLaser",this).call(this,e,n),-1!==this.directions.indexOf(n.direction)?this.hitBack(e,n):this.hitMirror(e,n)}},{key:"getFireDirections",value:function(){return[N(this.directions[0]),N(this.directions[1])]}},{key:"hitBack",value:function(e,t){this.handleMove(e,t,null,!0)}},{key:"hitMirror",value:function(e,t){var n=e.pending.find((function(e){e.from;var n=e.to;return y(n,t)})),r=this.getFireDirections(),c=this.directions[1-r.indexOf(t.direction)];k(e,Object(f.a)({},t,{direction:c}),!0),n&&[a.ICE,a.THIN_ICE].includes(e.board[t.y][t.x].background)&&x.checkLaser(e)}}]),t}(M),H=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="MIRROR_NE",n.directions=[A.UP,A.RIGHT],n}return Object(_.a)(t,e),t}(Y),z=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="MIRROR_SE",n.directions=[A.DOWN,A.RIGHT],n}return Object(_.a)(t,e),t}(Y),X=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="MIRROR_SW",n.directions=[A.DOWN,A.LEFT],n}return Object(_.a)(t,e),t}(Y),J=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(c)))).css="ROTARY_MIRROR_NW",n.directions=[A.UP,A.LEFT],n.next_direction=r.ROTARY_MIRROR_NE,n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"hitBack",value:function(e,t){e.board[t.y][t.x].object=this.next_direction}}]),t}(Y),q=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(c)))).css="ROTARY_MIRROR_NE",n.directions=[A.UP,A.RIGHT],n.next_direction=r.ROTARY_MIRROR_SE,n}return Object(_.a)(t,e),t}(J),$=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(c)))).css="ROTARY_MIRROR_SE",n.directions=[A.DOWN,A.RIGHT],n.next_direction=r.ROTARY_MIRROR_SW,n}return Object(_.a)(t,e),t}(J),Q=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(c)))).css="ROTARY_MIRROR_SW",n.directions=[A.DOWN,A.LEFT],n.next_direction=r.ROTARY_MIRROR_NW,n}return Object(_.a)(t,e),t}(J),Z=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="CRYSTAL_BLOCK",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLaser",value:function(e,t){}}]),t}(M),ee=function(e){function t(){return Object(v.a)(this,t),Object(T.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLanding",value:function(e,t,n){}},{key:"handleTank",value:function(e,t){}},{key:"handleTankMove",value:function(e){}},{key:"skipTank",value:function(e){}},{key:"cleanUp",value:function(e,t){}},{key:"shouldSkip",value:function(e,t){return!1}},{key:"shouldCheckTank",value:function(e,t){return!0}}]),t}(x),te=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="DIRT",n}return Object(_.a)(t,e),t}(ee),ne=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="MOVABLE_BLOCK_WATER",n}return Object(_.a)(t,e),t}(ee),ae=function(e,t){return e.background===a.TUNNEL&&t.background===a.TUNNEL&&e.color===t.color},re=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="TUNNEL",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLanding",value:function(e,n,a){Object(R.a)(Object(p.a)(t.prototype),"handleLanding",this).call(this,e,n,a);var r=e.board,c=r[a.y][a.x],i=!0;Object(j.each)(r,(function(e,t){return Object(j.each)(e,(function(e,n){if(ae(e,c)&&!y(a,{x:n,y:t})&&!e.object)return e.object=c.object,delete c.object,i=!1})),i})),i&&e.pendingTunnels.push(Object(f.a)({},a,{direction:A.UP}))}},{key:"handleTankMove",value:function(e){Object(R.a)(Object(p.a)(t.prototype),"handleTankMove",this).call(this,e);var n=e.board,a=e.tank,r=n[a.y][a.x],c=!0;Object(j.each)(n,(function(e,t){return Object(j.each)(e,(function(e,n){if(ae(e,r)&&!y(a,{x:n,y:t})&&!e.object)return a.x=n,a.y=t,c=!1})),c})),c&&e.pendingTunnels.push(Object(f.a)({},a,{direction:A.DOWN}))}},{key:"handleLeaving",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleLeaving",this).call(this,e,n);var a=e.board,r=e.tank,c=e.pendingTunnels,i=Object(j.findIndex)(c,(function(e){var t=e.x,r=e.y,c=e.direction;return ae(a[r][t],a[n.y][n.x])&&c===A.UP})),o=Object(j.findIndex)(c,(function(e){var t=e.x,r=e.y,c=e.direction;return ae(a[r][t],a[n.y][n.x])&&c===A.DOWN}));if(i>-1){var l=c.splice(i,1)[0];if(!y(l,n)){var u=a[l.y][l.x];if(u.object)Object(j.get)(a,[n.y,n.x]).object=u.object,delete u.object}}else if(o>-1){var s=c.splice(o,1)[0];!y(s,n)&&y(r,s)&&I(n,e.board)&&(r.x=n.x,r.y=n.y,e.rendering=!0)}}}]),t}(ee),ce=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="FLAG",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleTank",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleTank",this).call(this,e,n),e.status="WIN"}},{key:"skipTank",value:function(e){e.status="WIN"}}]),t}(ee),ie=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="WATER",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLanding",value:function(e,n,c){Object(R.a)(Object(p.a)(t.prototype),"handleLanding",this).call(this,e,n,c);var i=e.board[c.y][c.x];i.object===r.MOVABLE_BLOCK&&(i.background=a.MOVABLE_BLOCK_WATER),delete i.object}},{key:"handleTank",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleTank",this).call(this,e,n),e.status="FAIL"}},{key:"pending",value:function(e,n,a,r){Object(R.a)(Object(p.a)(t.prototype),"pending",this).call(this,e,n,a,r),this.handleLanding(e,n,a)}},{key:"skipTank",value:function(e){var t=e.board,n=e.prevTank;t[n.y][n.x].background===a.ICE&&this.handleTank(e,!0)}}]),t}(ee),oe=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="ICE",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLanding",value:function(e,n,a){Object(R.a)(Object(p.a)(t.prototype),"handleLanding",this).call(this,e,n,a);var r,c=this.getNextTarget(e,n,a,!0);c&&(null===(r=x.getObstacle(e.board[a.y][a.x]))||void 0===r||r.handleMove(e,a,c,!1))}},{key:"handleTank",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleTank",this).call(this,e,n);var a=e.tank,r=e.prevTank,c=g(r,a);c&&x.moveTank(e,L(Object(f.a)({},a,{direction:c})),!1,!1)}},{key:"pending",value:function(e,n,a,r){r&&!this.shouldPending(e,n,a)||Object(R.a)(Object(p.a)(t.prototype),"pending",this).call(this,e,n,a,r)}},{key:"shouldPending",value:function(e,t,n){return!!this.getNextTarget(e,t,n,!1)}},{key:"getNextTarget",value:function(e,t,n,a){var r=g(t,n);if(r){var c=L(Object(f.a)({},n,{direction:r}));if((!a||!y(e.tank,c))&&I(c,e.board))return c}return null}},{key:"shouldSkip",value:function(e,n){var a=Object(j.get)(e.board,[n.y,n.x]),r=x.getBackground(a);return!Boolean(a.object)&&!(r instanceof t)}},{key:"shouldCheckTank",value:function(e,t){var n=e.tank;return!t[n.y][n.x].object}}]),t}(ee),le=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="THIN_ICE",n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleLanding",value:function(e,n,a){Object(R.a)(Object(p.a)(t.prototype),"handleLanding",this).call(this,e,n,a),e.board[a.y][a.x].object&&(new ie).handleLanding(e,a,a),e.cleanUp.push(a)}},{key:"cleanUp",value:function(e,t){e.board[t.y][t.x].background=a.WATER}},{key:"shouldPending",value:function(e,t,n){return!0}},{key:"handleTank",value:function(e,n){var r=e.tank,c=e.board,i=Object(f.a)({},r),o=c[i.y][i.x];Object(R.a)(Object(p.a)(t.prototype),"handleTank",this).call(this,e,n),o.background=a.WATER,y(i,e.tank)&&x.getBackground(o).handleTank(e,n)}}]),t}(oe),ue=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="TANK_MOVER_N",n.direction=A.UP,n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"handleTank",value:function(e,n){Object(R.a)(Object(p.a)(t.prototype),"handleTank",this).call(this,e,n),x.moveTank(e,L(Object(f.a)({},e.tank,{direction:this.direction})),!1,!0)}},{key:"skipTank",value:function(e){x.moveTank(e,L(Object(f.a)({},e.tank,{direction:this.direction})),!1,!0)}},{key:"shouldSkip",value:function(e,n){var a=Object(j.get)(e.board,[n.y,n.x]),r=x.getBackground(a);return!Boolean(a.object)&&!(r instanceof t)}},{key:"shouldCheckTank",value:function(e,t){var n=e.board,a=e.tank;return!n[a.y][a.x].object}}]),t}(ee),se=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="TANK_MOVER_S",n.direction=A.DOWN,n}return Object(_.a)(t,e),t}(ue),de=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="TANK_MOVER_W",n.direction=A.LEFT,n}return Object(_.a)(t,e),t}(ue),Oe=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(T.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).css="TANK_MOVER_E",n.direction=A.RIGHT,n}return Object(_.a)(t,e),t}(ue),be=n(11),fe={0:{background:a.DIRT},2:{background:a.FLAG},3:{background:a.WATER},4:{object:r.SOLID_BLOCK},5:{object:r.MOVABLE_BLOCK},6:{object:r.BRICKS},7:{object:r.ANTI_TANK_N},8:{object:r.ANTI_TANK_E},9:{object:r.ANTI_TANK_S},10:{object:r.ANTI_TANK_W},11:{object:r.MIRROR_NW},12:{object:r.MIRROR_NE},13:{object:r.MIRROR_SE},14:{object:r.MIRROR_SW},15:{background:a.TANK_MOVER_N},16:{background:a.TANK_MOVER_E},17:{background:a.TANK_MOVER_S},18:{background:a.TANK_MOVER_W},19:{object:r.CRYSTAL_BLOCK},20:{object:r.ROTARY_MIRROR_NW},21:{object:r.ROTARY_MIRROR_NE},22:{object:r.ROTARY_MIRROR_SE},23:{object:r.ROTARY_MIRROR_SW},24:{background:a.ICE},25:{background:a.THIN_ICE}},ve=["FB2D0F","36FA0E","1538FF","36FCFF","FFFB0A","F542F9","FFFFFF","A1A1A1"],he=function(e){return ve[e]},je=function(e){return String.fromCharCode.apply(null,Array.from(new Uint8Array(e)).filter(Boolean))},Ee=function(e){return new Uint16Array(e)[0]},Re=function(e){return Array.from(new Uint8Array(e))},Te=function(e,t){for(var n=new Uint8Array(t),a=0;a<e.length&&a<t;a++)n[a]=e.charCodeAt(a);return n.buffer},pe=function(e,t){var n=new Uint16Array(1);return n[0]=e,n.buffer},_e=function(e,t){var n=new Uint8Array(t);return e.forEach((function(e,a){a<t&&(n[a]=e)})),console.log(e),n.buffer},me={board:[256,Re,function(e,t){return _e([].concat.apply([],e),t)}],levelName:[31,je,Te],hint:[256,je,Te],author:[31,je,Te],scoreDifficulty:[2,Ee,pe]},Ae=function(e){var t=Object(j.sumBy)(Object.values(me),(function(e){return e[0]}));return Object(j.map)(Object(j.range)(Math.floor(e.byteLength/t)),(function(n){var a=t*n,r={};return Object(j.map)(me,(function(t,n){var c=Object(be.a)(t,2),i=c[0],o=c[1];r[n]=o(e.slice(a,a+i)),a+=i})),Object(f.a)({},r,{board:Object(j.chunk)(r.board,16)})}))},ye={levelName:[31,je,Te],author:[31,je,Te],levelIndex:[2,Ee,pe],size:[2,Ee,pe]},ge=function(e,t){var n=document.createElement("a");n.href=URL.createObjectURL(new Blob(e,{type:"application/octet-stream"})),n.download=t,n.click()},Ne=function(e){var t,n,c=e.board,i=e.tank,o=e.levelName,l=e.hint,u=e.author,s=e.scoreDifficulty,d=Object(j.range)(0,16).map((function(){return Object(j.range)(0,16).map((function(){return 0}))})),O=(t={},Object(m.a)(t,r.BRICKS,6),Object(m.a)(t,r.SOLID_BLOCK,4),Object(m.a)(t,r.CRYSTAL_BLOCK,19),Object(m.a)(t,r.MOVABLE_BLOCK,5),Object(m.a)(t,r.ANTI_TANK_N,7),Object(m.a)(t,r.ANTI_TANK_S,9),Object(m.a)(t,r.ANTI_TANK_W,10),Object(m.a)(t,r.ANTI_TANK_E,8),Object(m.a)(t,r.ANTI_TANK_DEAD_N,7),Object(m.a)(t,r.ANTI_TANK_DEAD_S,9),Object(m.a)(t,r.ANTI_TANK_DEAD_W,10),Object(m.a)(t,r.ANTI_TANK_DEAD_E,8),Object(m.a)(t,r.MIRROR_NW,11),Object(m.a)(t,r.MIRROR_NE,12),Object(m.a)(t,r.MIRROR_SE,13),Object(m.a)(t,r.MIRROR_SW,14),Object(m.a)(t,r.ROTARY_MIRROR_NW,20),Object(m.a)(t,r.ROTARY_MIRROR_NE,21),Object(m.a)(t,r.ROTARY_MIRROR_SE,22),Object(m.a)(t,r.ROTARY_MIRROR_SW,23),Object(m.a)(t,r.TANT,1),t),b=(n={},Object(m.a)(n,a.FLAG,2),Object(m.a)(n,a.DIRT,0),Object(m.a)(n,a.WATER,3),Object(m.a)(n,a.MOVABLE_BLOCK_WATER,3),Object(m.a)(n,a.ICE,24),Object(m.a)(n,a.THIN_ICE,25),Object(m.a)(n,a.TANK_MOVER_N,15),Object(m.a)(n,a.TANK_MOVER_S,17),Object(m.a)(n,a.TANK_MOVER_E,16),Object(m.a)(n,a.TANK_MOVER_W,18),Object(m.a)(n,a.TUNNEL,64),n);c.forEach((function(e,t){return e.forEach((function(e,n){var r=e.object&&Object(j.get)(O,e.object)||Object(j.get)(b,e.background);e.background===a.TUNNEL&&(r=function(e){var t=ve.indexOf(e);return t>-1?t+64:64}(e.color||"")),d[n][t]=r}))})),d[i.y][i.x]=1;var f={board:d,levelName:o,hint:l,author:u,scoreDifficulty:s},v=Object(j.map)(me,(function(e,t){var n=Object(be.a)(e,3),a=n[0];n[1];return(0,n[2])(f[t],a)}));ge(v,"".concat(o,".lvl"))},ke=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j.identity;Object(v.a)(this,e),this.nodes=[],this.iteratee=j.identity,this.iteratee=Object(j.iteratee)(t)}return Object(h.a)(e,[{key:"isEmpty",value:function(){return 0===this.nodes.length}},{key:"pop",value:function(){return this.nodes.shift()}},{key:"insert",value:function(e){var t=this,n=Object(j.sortedLastIndexBy)(this.nodes,e,this.iteratee),a=this.iteratee(e),r=!1;Object(j.eachRight)(this.nodes.slice(0,n),(function(n){return n===e?(r=!0,!1):!(t.iteratee(n)<a)&&void 0})),r||this.nodes.splice(n,0,e)}},{key:"indexOf",value:function(e){var t=this,n=Object(j.sortedLastIndexBy)(this.nodes,e,this.iteratee),a=this.iteratee(e);return Object(j.eachRight)(this.nodes.slice(0,n),(function(r,c){return r===e?(n=c,!1):t.iteratee(r)<a?(n=-1,!1):void 0})),n}},{key:"remove",value:function(e){var t=this.indexOf(e);if(-1!==t)return this.nodes.splice(t,1)[0]}}]),e}(),Ie=function(e,t){for(var n=[t];t in e;)t=e[t],n.push(t);return Object(j.reverse)(n)},Le=function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},xe=16;!function(e){e.UP="N",e.DOWN="S",e.LEFT="W",e.RIGHT="E",e.FIRE=" ",e.UNDO="UNDO",e.PAUSE="PAUSE",e.NEXT_LEVEL="NEXT_LEVEL",e.PREV_LEVEL="PREV_LEVEL",e.PREV_FRAME="PREV_FRAME",e.NEXT_FRAME="NEXT_FRAME",e.LOAD_REC="LOAD_REC",e.PREV_REC="PREV_REC",e.NEXT_REC="NEXT_REC",e.CLOSE_REC="CLOSE_REC",e.TOGGLE_AUTO_REC="TOGGLE_AUTO_REC",e.EXPORT_REC="EXPORT_REC",e.TOGGLE_EDITOR="TOGGLE_EDITOR",e.SAVE_LEVEL="SAVE_LEVEL",e.HINT="HINT",e.RESTART="RESTART",e.SAVE_POSITION="SAVE_POSITION",e.RESTORE_POSITION="RESTORE_POSITION"}(A||(A={}));var Me=function(e){return[A.UP,A.DOWN,A.LEFT,A.RIGHT].includes(e)},Se=function(e){return Me(e)||e===A.FIRE},Ce=new(function(){function e(){Object(v.a)(this,e),this.record=[],this.history=[],this.frames=[],this.levels=[],this.snapshoot=null}return Object(h.a)(e,[{key:"save",value:function(e,t){var n=e.board,a=e.tank,r=e.prevTank,c=e.laser,i=e.pending,o=e.pendingTunnels,l=e.status,u=e.levelIndex;this.record.push(t),this.history.push({board:n,tank:a,prevTank:r,laser:c,pending:i,pendingTunnels:o,status:l,levelIndex:u})}},{key:"saveFrame",value:function(e){var t=e.board,n=e.tank,a=e.prevTank,r=e.laser,c=e.pending,i=e.pendingTunnels,o=e.status,l=e.levelIndex;this.frames.push({board:t,tank:n,prevTank:a,laser:r,pending:c,pendingTunnels:i,status:o,levelIndex:l})}},{key:"savePosition",value:function(e){var t=e.board,n=e.tank,a=e.prevTank,r=e.laser,c=e.pending,i=e.pendingTunnels,o=e.status,l=e.levelIndex;this.snapshoot={state:{board:t,tank:n,prevTank:a,laser:r,pending:c,pendingTunnels:i,status:o,levelIndex:l},record:this.record}}}]),e}()),De={board:x.createEmptyBoard(),tank:{x:0,y:0,direction:A.UP},prevTank:{x:0,y:0,direction:A.UP},laser:null,pending:[],pendingTunnels:[],status:"PLAYING",cleanUp:[],levelIndex:0,timer:0,rendering:!1,pause:!1,positionSaved:!1,pendingMoves:[],pendingMoveIndex:0,autoRec:!1,editor:!1,editorTile:{background:a.DIRT},frameIndex:0,level:null},Ke=Object(E.b)({name:"game",initialState:De,reducers:{loadLevels:function(e,t){var n=t.payload,a=n.levels,r=n.levelIndex;Ce.levels=a,localStorage.setItem("levels",JSON.stringify(a)),Ke.caseReducers.loadLevel(e,Ke.actions.loadLevel(r))},loadLevel:function(e,t){var n=t.payload,r=Object(j.get)(Ce.levels,[n]);if(r){e.level=r,localStorage.setItem("levelIndex",JSON.stringify(n));var c=function(e){var t=x.createEmptyBoard(),n={x:0,y:0,direction:A.UP};return e.board.forEach((function(e,r){return e.forEach((function(e,c){if(1===e)n.x=r,n.y=c,n.direction=A.UP,t[c][r]={background:a.DIRT};else if(e>63&&e<96)t[c][r]={color:he((15&e)>>1),background:a.TUNNEL};else{var i=fe[e];i||console.log(e),t[c][r]=Object(f.a)({background:a.DIRT},i)}}))})),{board:t,tank:n}}(r),i=c.board,o=c.tank;e.board=i,e.tank=o,e.prevTank=Object(f.a)({},o),e.laser=null,e.pending=[],e.pendingTunnels=[],e.timer=0===e.timer?1:0,e.rendering=!1,e.pause=!1,e.status="PLAYING",e.frameIndex=0,Ce.record=[],Ce.frames=[],e.levelIndex!==n&&(Ce.history=[],Ce.snapshoot=null,e.levelIndex=n,e.positionSaved=!1)}},undo:function(e){return Ce.record.pop(),Ce.frames=[],Object(f.a)({},e,{},Ce.history.pop(),{timer:e.timer+1,frameIndex:0})},savePosition:function(e){e.positionSaved=!0},restorePosition:function(e){var t,n;return Ce.record=Object(b.a)((null===(t=Ce.snapshoot)||void 0===t?void 0:t.record)||[]),Ce.frames=[],Object(f.a)({},e,{},(null===(n=Ce.snapshoot)||void 0===n?void 0:n.state)||{},{timer:e.timer+1,frameIndex:0})},setFrame:function(e,t){var n=t.payload;return Object(f.a)({},e,{},Ce.frames[Ce.frames.length-1-n],{frameIndex:n,timer:e.timer+1})},setAutoRec:function(e,t){e.autoRec=t.payload},pendingMoves:function(e,t){e.pendingMoveIndex=0,e.pendingMoves=t.payload,e.autoRec=!1},setPendingMove:function(e,t){Object(j.get)(e.pendingMoves,t.payload)?e.pendingMoveIndex=t.payload:(e.pendingMoveIndex=0,e.pendingMoves=[],e.autoRec=!1)},toggleEditor:function(e){e.editor=!e.editor},selectEditorTile:function(e,t){e.editorTile=t.payload},edit:function(e,t){var n=e.tank,a=e.board,c=e.editorTile,i=t.payload,o=i.x,l=i.y;a[l][o]=Object(f.a)({},c),c.object===r.TANT&&(delete a[l][o].object,n.x=o,n.y=l,n.direction=A.UP),e.timer+=1},moveTank:function(e,t){var n=e.tank,a=t.payload;Ce.frames=[],n.direction===a?x.moveTank(e,L(n),!0):(n.direction=a,e.prevTank=Object(f.a)({},n)),e.timer+=1,e.rendering="FAIL"!==e.status},fireTank:function(e){var t=e.tank;Ce.frames=[],e.laser||(e.laser=t,e.rendering=!0,e.timer+=1)},renderFrame:function(e){var t=e.board,n=Object(j.map)(t,(function(e){return Object(j.map)(e,(function(e){return Object(f.a)({},e)}))}));e.rendering=!1,x.checkLaser(e),x.checkPending(e),x.checkTank(e,n),x.cleanUp(e),e.timer+=1,e.rendering="PLAYING"===e.status&&(e.rendering||Boolean(e.laser)||e.pending.length>0)}}}),we=function(e,t){return function(n,a){var r=a().game.tank,c=e-r.x,i=t-r.y,o=r.direction;0===c&&0===i||(i>=Math.abs(c)?o=A.DOWN:-i>=Math.abs(c)?o=A.UP:c>0?o=A.RIGHT:c<0&&(o=A.LEFT)),o!==r.direction&&n(Fe(o)),n(Fe(A.FIRE))}},We=function(e,t){return function(n,r){var c=r().game,i=c.tank,o=c.board,l={x:e,y:t},u=function(e){var t=e.x;return(e.y*xe+t).toString()},s=function(e){var t=Object(j.toInteger)(e);return{x:t%xe,y:Math.floor(t/xe)}},b=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},f=function(e,t,n,a){var r={};r[e]={id:e,gScore:0,fScore:n};var c=new ke("fScore");c.insert(r[e]);for(var i={},o=function(){var e=c.pop();if(e.id===t)return{v:Ie(i,e.id)};a(e.id,(function(t,n,a){var o=e.gScore+n,l=o+a;t in r?o<r[t].gScore&&(i[t]=e.id,c.remove(r[t]),r[t].gScore=o,r[t].fScore=l,c.insert(r[t])):(r[t]={id:t,gScore:o,fScore:l},i[t]=e.id,c.insert(r[t]))}))};!c.isEmpty();){var l=o();if("object"===typeof l)return l.v}return!1}(u(i),u({x:e,y:t}),b(i,{x:e,y:t}),(function(e,t){var n=s(e),r=n.x,c=n.y;Object(j.each)([{x:r,y:c-1},{x:r+1,y:c},{x:r,y:c+1},{x:r-1,y:c}],(function(e){var n=Object(j.get)(o,[e.y,e.x]);n&&!n.object&&(y(l,e)||[a.DIRT,a.FLAG,a.MOVABLE_BLOCK_WATER].includes(n.background))&&t(u(e),1,b(e,i))}))})),v=function(){var e=Object(O.a)(d.a.mark((function e(){var t,a,c,i,o,l,u,O;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r(),a=t.game,c=t.ui,i=a.tank,o=a.rendering,!(f&&f.length>0)){e.next=8;break}return l=Date.now(),o||(u=s(f[0]),(O=g(i,u))?(O===i.direction&&f.shift(),n(Be(O))):f.shift()),e.next=7,Le(Object(j.max)([c.renderInterval-(Date.now()-l),0])||0);case 7:v();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();v()}},Fe=function(e){return function(t,n){var a=Ke.actions,r=n().game,c=r.tank,i=r.board,o=r.status,l=r.pending,u=r.laser,s=r.frameIndex;if(Se(e))if(s>0)t(a.setFrame(0));else if(0===l.length&&!u&&"PLAYING"===o){var d=L(c);e===A.FIRE?(Ce.save(r,e),t(a.fireTank()),Ce.saveFrame(r)):Me(e)&&(c.direction!==e||I(d,i))&&(Ce.save(r,e),t(a.moveTank(e)),Ce.saveFrame(r))}}},Be=function(e,t){return function(n,a){var r=Ke.actions,c=a().game,i=c.levelIndex,o=c.frameIndex,l=c.pendingMoves,u=c.pendingMoveIndex,s=c.autoRec,b=c.board,v=c.tank;if(e===A.PREV_FRAME)n(r.setFrame(Object(j.min)([o+1,Ce.frames.length-1])||Ce.frames.length-1));else if(e===A.NEXT_FRAME)n(r.setFrame(Object(j.max)([o-1,0])||0));else if(e===A.UNDO)n(r.undo());else if(e===A.RESTART)n(r.loadLevel(i));else if(e===A.SAVE_POSITION&&0===o)Ce.savePosition(c),n(r.savePosition());else if(e===A.RESTORE_POSITION)n(r.restorePosition());else if(e===A.NEXT_LEVEL)n(r.loadLevel(i+1));else if(e===A.PREV_LEVEL)n(r.loadLevel(i-1));else if(e===A.TOGGLE_EDITOR)n(r.toggleEditor());else if(e===A.SAVE_LEVEL)Ne({board:b,tank:v,levelName:t.levelName,hint:t.hint||"",author:t.author,scoreDifficulty:t.scoreDifficulty});else if(e===A.LOAD_REC)n(r.loadLevel(i)),n(r.pendingMoves(t));else if(e===A.TOGGLE_AUTO_REC)n(r.setAutoRec(!s)),n(function e(){return function(){var t=Object(O.a)(d.a.mark((function t(n,a){var r,c,i,o,l,u,s,O,b;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a(),c=r.ui,i=r.game,o=i.autoRec,l=i.rendering,u=i.pendingMoves,s=i.pendingMoveIndex,O=i.status,!(o&&s<u.length&&"PLAYING"===O)){t.next=8;break}return b=Date.now(),l||n(Be(A.NEXT_REC)),t.next=7,Le(Object(j.max)([c.renderInterval-(Date.now()-b),0])||0);case 7:n(e());case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}());else if(e===A.PREV_REC)n(r.setPendingMove(u-1)),n(r.undo());else if(e===A.NEXT_REC){var h=Object(j.get)(l,[u]);h&&(n(r.setPendingMove(u+1)),n(Fe(h)))}else if(e===A.CLOSE_REC)n(r.pendingMoves([]));else if(e===A.EXPORT_REC){var E=Ce.levels[i];E&&function(e){var t,n=(t={},Object(m.a)(t,A.FIRE,32),Object(m.a)(t,A.LEFT,37),Object(m.a)(t,A.UP,38),Object(m.a)(t,A.RIGHT,39),Object(m.a)(t,A.DOWN,40),t),a=Object(j.map)(e.records,(function(e){return n[e]})),r=Object(f.a)({},e,{levelIndex:26,size:a.length,records:a}),c=Object(f.a)({},ye,{records:[a.length,Re,_e]}),i=Object(j.map)(c,(function(e,t){var n=Object(be.a)(e,3),a=n[0];n[1];return(0,n[2])(r[t],a)}));ge(i,"level_".concat(e.levelIndex,".lpb"))}({levelName:E.levelName,author:"",levelIndex:i+1,records:Ce.record})}else Se(e)&&Object(j.isEmpty)(l)&&n(Fe(e))}},Pe=Ke,Ve=n(23),Ue=i.a.memo((function(e){var t=e.tile,n=e.tileSize,r=e.onClick,c=e.onContextMenu;return i.a.createElement("div",{style:{width:n,height:n},className:["board-object",x.getBackgroundCss(t)].filter(Boolean).join(" "),onClick:r,onContextMenu:c},t.background===a.TUNNEL&&i.a.createElement("div",{style:{background:"transparent",borderRadius:"50%",border:"".concat(n/8,"px solid #").concat(t.color),boxSizing:"border-box",pointerEvents:"none"}}),t.object&&i.a.createElement("div",{className:x.getObstacleCss(t),style:{pointerEvents:"none"}}))})),Ge=(n(55),i.a.memo((function(e){var t=e.row,n=e.rowIndex,a=e.tileSize,r=Object(u.b)();return i.a.createElement("div",{className:"row"},Object(j.map)(t,(function(e,t){var c=t,o=n;return i.a.createElement(Ue,{key:t,tile:e,tileSize:a,onClick:function(e){r(function(e,t){return function(n,a){n(a().game.editor?Ke.actions.edit({x:e,y:t}):We(e,t))}}(c,o))},onContextMenu:function(e){e.preventDefault(),r(we(c,o))}})})))}))),Ye=function(e){var t;return(t={},Object(m.a)(t,A.UP,"N"),Object(m.a)(t,A.DOWN,"S"),Object(m.a)(t,A.LEFT,"W"),Object(m.a)(t,A.RIGHT,"E"),t)[e]},He=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(T.a)(this,Object(p.a)(t).call(this,e))).state={limit:0},n.boardRef=i.a.createRef(),n.interval=void 0,Object(j.bindAll)(Object(Ve.a)(n),["handleResize"]),n}return Object(_.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.handleResize);var t=["bg0","bg1","bg2"];this.interval=setInterval(Object(O.a)(d.a.mark((function n(){var a,r,c;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.props.animation&&(a=e.boardRef.current)&&(r=a.querySelectorAll([".ANTI_TANK_N",".ANTI_TANK_E",".ANTI_TANK_S",".ANTI_TANK_W",".TANK_MOVER_N",".TANK_MOVER_S",".TANK_MOVER_W",".TANK_MOVER_E",".FLAG",".WATER"].join(", ")),c=t.shift()||"",r.forEach((function(e){var n;(n=e.classList).remove.apply(n,t),e.classList.add(c)})),t.push(c));case 1:case"end":return n.stop()}}),n)}))),600),this.handleResize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),clearInterval(this.interval)}},{key:"handleResize",value:function(){if(this.boardRef.current){var e,t=this.boardRef.current,n=t.offsetWidth,a=t.offsetHeight;this.setState({limit:null!==(e=Object(j.min)([n,a]))&&void 0!==e?e:0})}}},{key:"shouldComponentUpdate",value:function(e,t){return t.limit!==this.state.limit||e.game.timer!==this.props.game.timer}},{key:"render",value:function(){var e=this.props,t=e.game,n=e.dispatch,a=this.state.limit,r=t.board,c=t.tank,o=t.laser,l=Math.floor(a/(xe+2)),u={width:l,height:l};return i.a.createElement("div",{ref:this.boardRef,className:"Board"},i.a.createElement("div",null,Object(j.map)(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P"],(function(e,t){return i.a.createElement("div",{key:t,style:{width:l,display:"inline-block"}},e)}))),i.a.createElement("div",{style:{width:l*xe,height:l*xe,margin:"0 auto"}},Object(j.map)(r,(function(e,t){return i.a.createElement(Ge,{key:t,rowIndex:t,row:e,tileSize:l})})),Object(j.map)(Object(j.range)(xe),(function(e){return i.a.createElement("div",{key:e,style:{position:"absolute",verticalAlign:"center",lineHeight:"".concat(l,"px"),left:-l,top:e*l}},e+1)})),i.a.createElement("div",{className:"tank TANK_".concat(Ye(c.direction)),style:Object(f.a)({left:c.x*l,top:c.y*l},u),onContextMenu:function(e){e.preventDefault(),n(we(c.x,c.y))}}),o&&i.a.createElement("div",{className:"laser ".concat(Ye(o.direction)),style:[A.UP,A.DOWN].includes(o.direction)?Object(f.a)({left:o.x*l+(l/2-2),top:o.y*l},u,{width:4}):Object(f.a)({left:o.x*l,top:o.y*l+(l/2-1)},u,{height:4})})),i.a.createElement("div",null,Object(j.map)(Object(j.range)(0,16),(function(e){return i.a.createElement("div",{key:e,style:{width:l,display:"inline-block"}},e+1)}))))}}]),t}(i.a.Component),ze=function(){var e=Object(u.c)((function(e){return e.game})),t=Object(u.c)((function(e){return e.ui})),n=Object(u.b)(),a=e.status,r=e.levelIndex,o=Object(j.debounce)((function(){return n((function(e,t){e(Ke.actions.renderFrame()),Ce.saveFrame(t().game)}))}),t.renderInterval);return Object(c.useEffect)((function(){var e=function(e){var t={ARROWUP:A.UP,ARROWDOWN:A.DOWN,ARROWLEFT:A.LEFT,ARROWRIGHT:A.RIGHT,U:A.UNDO," ":A.FIRE,P:A.PAUSE}[e.key.toUpperCase()];t&&n(Be(t))};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[n]),Object(c.useEffect)((function(){e.rendering&&!e.pause&&o()}),[o,e]),Object(c.useEffect)((function(){"WIN"===a&&(o.cancel(),n(Pe.actions.loadLevel(r+1)))}),[n,r,a,o]),i.a.createElement(He,{game:e,animation:t.animation,dispatch:n})},Xe=n(27),Je=Object(E.b)({name:"game",initialState:{renderInterval:100,animation:!0},reducers:{setRenderInterval:function(e,t){var n=t.payload;n>=0&&n<=1e4&&(e.renderInterval=n)},toggleAnimation:function(e){e.animation=!e.animation}}}),qe=(n(56),function(){var e=Object(u.b)(),t=Pe.actions,n=Object(c.useState)(null),a=Object(be.a)(n,2),r=a[0],o=a[1],l=function(n,a){var r=new FileReader;r.onload=function(n){var r;if(null===(r=n.target)||void 0===r?void 0:r.result){var c,i=null===(c=n.target)||void 0===c?void 0:c.result;if("lvl"===a)e(t.loadLevels({levels:Ae(i),levelIndex:0}));else{var o=function(e){var t={},n=0;Object(j.map)(ye,(function(a,r){var c=Object(be.a)(a,2),i=c[0],o=c[1];t[r]=o(e.slice(n,n+i)),n+=i}));var a=t.size;return delete t.size,Object(f.a)({},t,{records:Object(j.map)(new Uint8Array(e.slice(n,n+a)),(function(e){var t={32:A.FIRE,37:A.LEFT,38:A.UP,39:A.RIGHT,40:A.DOWN};if(!(e in t))throw new Error("wrong data in rec file: ".concat(e));return t[e]}))})}(i).records;e(Be(A.LOAD_REC,o))}}},r.readAsArrayBuffer(n)};return i.a.createElement("div",{className:"MenuBar"},Object(j.map)([{name:"Game",items:[{render:function(){return i.a.createElement("div",null,i.a.createElement("label",null,"Open Data File",i.a.createElement("input",{type:"file",style:{display:"none"},onChange:function(e){var t=e.currentTarget.files;(null===t||void 0===t?void 0:t.length)&&l(t[0],"lvl"),o(null)}})))}},{render:function(){return i.a.createElement("div",null,i.a.createElement("label",null,"Open Playback File",i.a.createElement("input",{type:"file",style:{display:"none"},onChange:function(e){var t=e.currentTarget.files;(null===t||void 0===t?void 0:t.length)&&l(t[0],"lpb"),o(null)}})))}},{name:"Save Recording",onClick:function(){e(Be(A.EXPORT_REC))}}]},{name:"Options",items:[{name:"Animation",onClick:function(){e(Je.actions.toggleAnimation())}}]},{name:"Editor",onClick:function(){o(null),e(Be(A.TOGGLE_EDITOR))}},{name:"Help",items:[{name:"About"}]},{name:"GitHub",onClick:function(){window.open("https://github.com/xiaohanzhang/laser-tank")}}],(function(e,t){var n=e.name,a=Object(Xe.a)(e,["name"]);return i.a.createElement("div",Object.assign({key:t,className:"MenuBarItem ".concat(n===(null===r||void 0===r?void 0:r.menu.name)?"active ":""),onClick:function(t){var n=t.currentTarget,a=n.offsetTop,c=n.offsetHeight,i=n.offsetLeft;o(r?null:{menu:e,top:a+c,left:i})},onMouseEnter:function(t){var n=t.currentTarget,a=n.offsetTop,c=n.offsetHeight,i=n.offsetLeft;r&&o({menu:e,top:a+c,left:i})}},a),n)})),i.a.createElement("ul",{className:"Menu",style:(null===r||void 0===r?void 0:r.menu.items)?{top:r.top,left:r.left}:{display:"none"}},Object(j.map)(null===r||void 0===r?void 0:r.menu.items,(function(e,t){var n=e.name,a=e.render,r=Object(Xe.a)(e,["name","render"]);return i.a.createElement("li",{key:t},a?a():i.a.createElement("div",r,n))}))))}),$e=n(14),Qe=n(15);function Ze(){var e=Object($e.a)(["\n    flex: 1;\n    cursor: pointer;\n    margin: 3px;\n    text-align: center;\n    vertical-align: middle;\n    line-height: 26px;\n    height: 30px;\n    border: 1px solid #B1B1B1;\n    border-radius: 3px;\n"]);return Ze=function(){return e},e}var et=Qe.a.button(Ze());function tt(){var e=Object($e.a)(["\n    position: sticky;\n    top: 0;\n"]);return tt=function(){return e},e}function nt(){var e=Object($e.a)(["\n    position: fixed; \n    overflow: scroll;\n    padding: 10px;\n    width: 80%;\n    height: 70%; \n    left: 10%; \n    top: 10%;\n    background: white;\n\n    box-shadow: 2px 2px 10px -1px rgba(0,0,0,0.2);\n    border-radius: 7px;\n"]);return nt=function(){return e},e}var at=Qe.a.div(nt()),rt=(Qe.a.div(tt()),at);function ct(){var e=Object($e.a)(["\n    width: 100%;\n    font-size: 18px;\n\n    th {\n        text-align: left;\n        padding-left: 10px;\n    }\n\n    td > * {\n        width: 100%;\n    }\n\n    input, textarea {\n        font-size: 18px;\n    }\n"]);return ct=function(){return e},e}function it(){var e=Object($e.a)(["\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    justify-content: flex-start;\n    align-items: flex-start;\n    align-content: flex-start;\n    padding: 0 1px;\n\n    div {\n        flex: 0 0 42px;\n        margin: 1px;\n    }\n"]);return it=function(){return e},e}var ot=Qe.a.div(it()),lt=Qe.a.table(ct()),ut=function(){var e=Object(u.b)(),t=Object(c.useState)(!1),n=Object(be.a)(t,2),o=n[0],l=n[1],s={},d=function(e){return function(t){s[e]=t.target.value}};return i.a.createElement(ot,null,Object(j.map)([{background:a.DIRT},{object:r.TANT},{background:a.FLAG},{background:a.WATER},{object:r.SOLID_BLOCK},{object:r.MOVABLE_BLOCK},{object:r.BRICKS},{object:r.ANTI_TANK_N},{object:r.ANTI_TANK_E},{object:r.ANTI_TANK_S},{object:r.ANTI_TANK_W},{object:r.MIRROR_NW},{object:r.MIRROR_NE},{object:r.MIRROR_SE},{object:r.MIRROR_SW},{background:a.TANK_MOVER_N},{background:a.TANK_MOVER_E},{background:a.TANK_MOVER_S},{background:a.TANK_MOVER_W},{object:r.CRYSTAL_BLOCK},{object:r.ROTARY_MIRROR_NW},{object:r.ROTARY_MIRROR_NE},{object:r.ROTARY_MIRROR_SE},{object:r.ROTARY_MIRROR_SW},{background:a.ICE},{background:a.THIN_ICE},{background:a.TUNNEL}],(function(t,n){var r=Object(f.a)({background:a.DIRT},t);return i.a.createElement(Ue,{key:n,tile:r,tileSize:42,onClick:function(t){if(r.background===a.TUNNEL){var n=Object(j.toNumber)(prompt("Enter the ID Number for this Tunnel (0-7): "));n>=0&&n<=7&&(r.color=he(n))}e(Pe.actions.selectEditorTile(r))}})})),i.a.createElement("div",{style:{flex:"1 0 178px"}},Object(j.map)([[{name:"Save Level",onClick:function(){l(!0)}},{name:"Close Editor",cmd:A.TOGGLE_EDITOR}]],(function(t,n){return i.a.createElement("div",{key:n,style:{display:"flex",flexDirection:"row"}},Object(j.map)(t,(function(t,n){var a=t.name,r=t.cmd,c=t.onClick,o=t.disabled;return i.a.createElement(et,{key:n,disabled:o,onClick:function(t){c?c(t):r&&e(Be(r))}},a)})))}))),o&&i.a.createElement(rt,null,i.a.createElement(lt,null,i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Level Name: "),i.a.createElement("td",null,i.a.createElement("input",{type:"text",onChange:d("levelName")}))),i.a.createElement("tr",null,i.a.createElement("th",null,"Author: "),i.a.createElement("td",null,i.a.createElement("input",{type:"text",onChange:d("author")}))),i.a.createElement("tr",null,i.a.createElement("th",null,"Difficulty: "),i.a.createElement("td",null,i.a.createElement("select",{onChange:d("scoreDifficulty")},i.a.createElement("option",{value:"1"},"Kids"),i.a.createElement("option",{value:"2"},"Easy"),i.a.createElement("option",{value:"4"},"Medium"),i.a.createElement("option",{value:"8"},"Hard"),i.a.createElement("option",{value:"16"},"Deadly")))),i.a.createElement("tr",null,i.a.createElement("th",null,"Hint: "),i.a.createElement("td",null,i.a.createElement("textarea",{rows:8,onChange:d("hint")}))),i.a.createElement("tr",null,i.a.createElement("th",null),i.a.createElement("td",null,i.a.createElement(et,{onClick:function(){var t=[];s.levelName&&s.author||t.push("Level Name and Author can not be empty.");var n=Object(j.toNumber)(s.scoreDifficulty)||1;[1,2,4,8,16].includes(n)||t.push("Please select a difficulty from dropdown."),Object(j.isEmpty)(t)?(l(!1),e(Be(A.SAVE_LEVEL,s))):alert(t.join("\n"))}},"Save Level")))))))},st=(n(57),Je.actions.setRenderInterval),dt=function(e){var t=e.levels,n=e.onClick,a=e.onClose;return i.a.createElement("div",{className:"LevelsPopup"},i.a.createElement("div",{style:{fontSize:20,textAlign:"end",cursor:"pointer",position:"sticky",top:0},onClick:a},"\xd7"),i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Lev #"),i.a.createElement("th",null,"Name"),i.a.createElement("th",null,"Author"))),i.a.createElement("tbody",null,Object(j.map)(t,(function(e,t){return i.a.createElement("tr",{key:t,className:t%2===0?"odd":"even",onClick:function(){n(t)}},i.a.createElement("td",null,t+1),i.a.createElement("td",null,e.levelName),i.a.createElement("td",null,e.author))})))))},Ot=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.game})),n=Object(u.c)((function(e){return e.ui})),a=Object(c.useState)(!1),r=Object(be.a)(a,2),o=r[0],l=r[1],s=t.levelIndex,d=t.level,O=t.positionSaved,b=t.frameIndex,f=t.pendingMoves,v=t.autoRec,h=t.editor,E=Ce.record,R=A.UP,T=0,p=0;return Object(j.map)(E,(function(e){Me(e)?e===R?p+=1:R=e:T+=1})),i.a.createElement("div",{className:"control-panel"},i.a.createElement("div",{className:"info",style:{position:"relative"}},d&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"absolute",top:39,left:43,height:20,width:93,textAlign:"center",color:"#0df90a"}},s+1),i.a.createElement("div",{style:{position:"absolute",top:95,left:9,height:20,width:160,textAlign:"center",color:"#0df90a",fontSize:d.levelName.length>20?11:14}},d.levelName),i.a.createElement("div",{style:{position:"absolute",top:144,left:9,height:20,width:160,textAlign:"center",color:"#0df90a",fontSize:d.author.length>20?11:14}},d.author),i.a.createElement("div",{style:{position:"absolute",top:200,left:20,height:20,width:57,textAlign:"center",color:"#0df90a"}},p),i.a.createElement("div",{style:{position:"absolute",top:200,left:103,height:20,width:57,textAlign:"center",color:"#0df90a"}},T),i.a.createElement("div",null))),h?i.a.createElement(ut,null):i.a.createElement("div",{className:"control"},Object(j.map)([Object(j.isEmpty)(f)&&[{name:"Undo",cmd:A.UNDO,disabled:b>0},{name:"Hint",onClick:function(){(null===d||void 0===d?void 0:d.hint)&&alert(null===d||void 0===d?void 0:d.hint)}}],Object(j.isEmpty)(f)&&[{name:"Save",disabled:b>0,cmd:A.SAVE_POSITION},{name:"Restore",cmd:A.RESTORE_POSITION,disabled:b>0&&!O}],Object(j.isEmpty)(f)&&[{name:"Restart",cmd:A.RESTART},{name:"Load Level",onClick:function(){l(!0)}}],Object(j.isEmpty)(f)&&[{name:"<< Level",cmd:A.PREV_LEVEL},{name:"Level >>",cmd:A.NEXT_LEVEL}],!Object(j.isEmpty)(f)&&[{name:v?"Pause":"Auto",cmd:A.TOGGLE_AUTO_REC},{name:"Close Rec",cmd:A.CLOSE_REC}],!Object(j.isEmpty)(f)&&!v&&[{name:"<< Step",cmd:A.PREV_REC},{name:"Step >>",cmd:A.NEXT_REC}],Object(j.isEmpty)(f)&&[{name:"<< Frame",cmd:A.PREV_FRAME},{name:"Frame >>",cmd:A.NEXT_FRAME,disabled:0===b}]].filter(Boolean),(function(t,n){return i.a.createElement("div",{key:n},Object(j.map)(t,(function(t,n){var a=t.name,r=t.cmd,c=t.onClick,o=t.disabled;return i.a.createElement("button",{key:n,disabled:o,onClick:function(t){c?c(t):r&&e(Be(r))}},a)})))})),i.a.createElement("div",{style:{flexDirection:"column",alignItems:"flex-start"}},i.a.createElement("div",null,i.a.createElement("label",{style:{flex:1}},"speed(0 - 10000): ")),i.a.createElement("div",null,i.a.createElement("input",{style:{flex:3},value:n.renderInterval,onChange:function(t){e(st(Object(j.toNumber)(t.target.value)))}}),i.a.createElement("span",null,"ms")))),o&&i.a.createElement(dt,{levels:Ce.levels,onClose:function(){return l(!1)},onClick:function(t){e(Pe.actions.loadLevel(t)),l(!1)}}))},bt=function(){var e=Object(u.b)();return Object(c.useEffect)((function(){try{var t,n,a=JSON.parse(null!==(t=localStorage.getItem("levels"))&&void 0!==t?t:""),r=JSON.parse(null!==(n=localStorage.getItem("levelIndex"))&&void 0!==n?n:"0");a&&e(Pe.actions.loadLevels({levels:a,levelIndex:r}))}catch(c){alert("failed to load levels: ".concat(c))}}),[e]),i.a.createElement("div",{className:"App"},i.a.createElement(qe,null),i.a.createElement("div",{className:"main"},i.a.createElement(ze,null),i.a.createElement(Ot,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ft=n(12),vt=Object(ft.combineReducers)({game:Pe.reducer,ui:Je.reducer}),ht=Object(E.a)({reducer:vt});l.a.render(i.a.createElement(u.a,{store:ht},i.a.createElement(bt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[38,1,2]]]);
//# sourceMappingURL=main.501a1fbd.chunk.js.map